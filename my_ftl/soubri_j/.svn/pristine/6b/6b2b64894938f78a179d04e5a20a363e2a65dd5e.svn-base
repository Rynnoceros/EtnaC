/*
** ETNA PROJECT, 13/11/2018 by soubri_j
** system_repair.c
** File description: 
**      This file contains all the methods used to repair ship systems.
*/

#include "ftl.h"

/*
    Function used to repair ship's engine
    Params : 
        ship : The ship to repair
*/
void ftl_drive_system_repair(ship_t *ship)
{
    int ret = 0;

    my_putstr_color("yellow", "repair of the reactor in progress...\n");
    if (ship != NULL) {
        if (ship->engine != NULL) {
            if (ship->engine->system_state != NULL) {
                free(ship->engine->system_state);
                ship->engine->system_state = my_strdup("online");
                if (ship->engine->system_state != NULL) {
                    ret = 1;
                }
            }
        }
    }
    if (ret == 0) {
        my_putstr_color("red", "the reactor repairs failed\n");
    } else if (ret == 1) {
        my_putstr_color("green", "repair complete! reactor system OK!\n");
    }
}

/*
    Function used to repair ship's navigation tools
    Params : 
        ship : The ship to repair
*/
void navigation_tools_system_repair(ship_t *ship)
{
    int ret = 0;

    my_putstr_color("yellow", "repair of the navigation tools system in progress...\n");
    if (ship != NULL) {
        if (ship->nav_tools != NULL) {
            if (ship->nav_tools->system_state != NULL) {
                free(ship->nav_tools->system_state);
                ship->nav_tools->system_state = my_strdup("online");
                if (ship->nav_tools->system_state != NULL) {
                    ret = 1;
                }
            }
        }
    }
    if (ret == 0) {
        my_putstr_color("red", "the navigation tools repairs failed\n");
    } else if (ret == 1) {
        my_putstr_color("green", "repair complete! navigation tools system OK!\n");
    }
}

/*
    Function used to repair ship's weapon
    Params : 
        ship : The shp to repair
*/
void weapon_system_repair(ship_t *ship)
{
    int ret = 0;

    my_putstr_color("yellow", "repair of the weapon system in progress...\n");
    if (ship != NULL) {
        if (ship->weapon != NULL) {
            if (ship->weapon->system_state != NULL) {
                free(ship->weapon->system_state);
                ship->weapon->system_state = my_strdup("online");
                if (ship->weapon->system_state != NULL) {
                    ret = 1;
                }
            }
        }
    }
    if (ret == 0) {
        my_putstr_color("red", "the weapon system repairs failed\n");
    } else if (ret == 1) {
        my_putstr_color("green", "repair complete! weapon system OK!\n");
    }
}